{% extends "library/base.html" %}

{% block content %}
  <h1>Willkommen zur Bücherliste</h1>
  <p>
    Hier kannst du ein neues Buch erstellen:
    <a href="{% url 'book_create' %}">Erstellen</a>
  </p>

  <!--Suchleiste-->
  <form method="get" action="{% url 'book_list' %}">
    <input
      type="text"
      name="q"
      placeholder="Nach Titel, Author oder Genre suchen..."
      value="{{ request.GET.q }}"
    >
    <button type="submit">Suchen</button>

    <!--Dropdown Filter-->
  <select name="genre">
    <option value="">Alle Genres</option>
    {% for g in genres %}
      <option value="{{ g }}" {% if request.GET.genre == g %}selected{% endif %}>
        {{ g }}
      </option>
    {% endfor %}
    </select>

    <select name="publisher">
    <option value="">Alle Verlage</option>
    {% for p in publishers %}
      <option value="{{ p.id }}" {% if request.GET.publisher == p.id|stringformat:"s" %}selected{% endif %}>
        {{ p.name }}
      </option>
    {% endfor %}
    </select>

    <select name="author">
    <option value="">Alle Autoren</option>
    {% for a in authors %}
      <option value="{{ a.id }}" {% if request.GET.author|default:"" == a.id|stringformat:"s" %}selected{% endif %}>
        {{ a.Vorname }} {{ a.Nachname }}
      </option>
    {% endfor %}
    </select>


    <button type="submit">Filter anwenden</button>
  </form>

  

  <ul>
    {% for b in all_items %}
      <li>
        <a href="{% url 'book_detail' b.pk %}">{{ b.Titel }}</a>
        - <a href="{% url 'book_update' b.pk %}">Bearbeiten</a>
        - <a href="{% url 'book_delete' b.pk %}">Löschen</a>
      </li>
    {% empty %}
      <li>Noch keine Bücher vorhanden.</li>
    {% endfor %}
  </ul>
{% endblock %}